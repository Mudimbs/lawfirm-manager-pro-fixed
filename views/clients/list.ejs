<%- include("../partials/header") %>
<div style="display:flex; justify-content:space-between; align-items:center;">
  <h1>Clients</h1>
  <a class="btn primary" href="/clients/new">+ Nouveau client</a>
</div>
<form method="get" style="margin:10px 0;">
  <input name="q" placeholder="Rechercher par nom, email, téléphone" value="<%= typeof q !== 'undefined' ? q : '' %>"/>
  <button class="btn">Rechercher</button>
</form>
<table>
  <thead>
    <tr><th>Nom complet</th><th>Téléphone</th><th>Email</th><th>Adresse</th><th>Actions</th></tr>
  </thead>
  <tbody>
    <% clients.forEach(c => { %>
      <tr>
        <td><%= c.fullname %></td>
        <td><%= c.phone || "" %></td>
        <td><%= c.email || "" %></td>
        <td><%= c.address || "" %></td>
        <td>
          <a class="btn" href="/clients/<%= c.id %>/edit">Modifier</a>
          <% if (user && user.role === 'admin') { %><form action="/clients/<%= c.id %>/delete" method="post" style="display:inline;">
            <button class="btn danger" onclick="return confirm('Supprimer ce client ?')">Supprimer</button>
          </form>
        </td><% } %>
      </tr>
    <% }) %>
  </tbody>
</table>
<%- include("../partials/footer") %>
